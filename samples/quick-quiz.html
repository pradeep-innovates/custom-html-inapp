<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vertical Sliding Questions</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
    <style>
      :root {
        --question-font-size: 20px;
        --option-font-size: 18px;
        --bg-color: #f4ecfa;
        --box-bg: #7238a0;
        --box-border: #9d72c3;
        --font-color: white;
        --next-btn-bg: #4a2574;
        --back-btn-bg: #9d72c3;
      }

      body {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 99vh;
        background-size: cover;
        margin: 1;
      }

      .container {
        width: 90vh;
        height: 100%;
        position: relative;
        box-sizing: border-box;
        padding-top: 25%;
        background-color: transparent;
        transition: background-color 2s ease;
      }

      .header-image {
        margin: 5%;
        position: absolute;
        margin-left: 7%;
        width: 85%;
        max-height: 100%;
        object-fit: cover;
        top: 34%;
        filter: drop-shadow(12px 12px 18px rgba(50, 50, 50, 0.5))
          drop-shadow(-4px -4px 10px rgba(200, 200, 200, 0.3));
      }

      .slider {
        display: flex;
        flex-direction: column;
        overflow-y: scroll;
        scroll-snap-type: y mandatory;
        width: 100%;
        height: 40%;
        scroll-behavior: smooth;
        transition: scroll-top 1s ease;
        padding: 0 5%;
        box-sizing: border-box;
        top: 60%;
        position: relative;
      }

      .box {
        flex: 0 0 100%;
        width: 100%;
        background-color: var(--box-bg);
        border: 2px solid var(--box-border);
        color: var(--font-color);
        font-size: 18px;
        box-sizing: border-box;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        align-items: center;
        padding: 20px;
        border-radius: 25px;
        margin-bottom: 10px;
        scroll-snap-align: start;
      }

      .question {
        margin-top: 30px;
        font-size: var(--question-font-size);
      }

      .options {
        display: flex;
        gap: 10px;
      }

      .option {
        display: flex;
        align-items: center;
      }

      .option label {
        margin-left: 5px;
        font-size: var(--option-font-size);
      }

      .btn-group {
        display: flex;
        gap: 10px;
      }

      .btn {
        padding: 10px 20px;
        font-size: 16px;
        cursor: pointer;
        border: none;
        border-radius: 5px;
        width: 100px;
        text-align: center;
      }

      .next-btn {
        background-color: var(--next-btn-bg);
        color: var(--font-color);
      }

      .back-btn {
        background-color: var(--back-btn-bg);
        color: var(--font-color);
      }

      @keyframes growOut {
        from {
          transform: scale(1);
          opacity: 1;
        }

        to {
          transform: scale(0.8);
          opacity: 0;
        }
      }

      @keyframes growIn {
        from {
          transform: scale(0.8);
          opacity: 0;
        }

        to {
          transform: scale(1);
          opacity: 1;
        }
      }

      .hidden {
        animation: growOut 1s ease forwards;
      }

      .visible {
        animation: growIn 1s ease forwards;
      }

      .results {
        position: relative;
        opacity: 0;
        font-size: 24px;
        font-weight: bold;
        color: var(--font-color);
        text-align: center;
        transform: translate(-50%, -50%) scale(0.8);
      }
    </style>
  </head>

  <body>
    <div class="container" id="container">
      <img
        src="https://iili.io/dk51tBn.md.png"
        alt="Top Image"
        class="header-image"
        id="header-image"
      />
      <div class="slider" id="slider">
        <!-- Boxes dynamically populated -->
      </div>
      <div class="box results" id="results">You have passed the Quiz</div>
    </div>

    <script>
      const quizData = [
        {
          question: "Who will win 1 ?",
          options: [
            { value: "RMA", label: "RMA" },
            { value: "ATM", label: "RMA" },
          ],
          correct: "New Delhi",
        },
        {
          question: "What is the capital of France?",
          options: [
            { value: "Paris", label: "Paris" },
            { value: "Rome", label: "Rome" },
          ],
          correct: "Paris",
        },
        {
          question: "Which planet is known as the Red Planet?",
          options: [
            { value: "Mars", label: "Mars" },
            { value: "Jupiter", label: "Jupiter" },
          ],
          correct: "Mars",
        },
        {
          question: "What is the largest ocean on Earth?",
          options: [
            { value: "Pacific Ocean", label: "Pacific Ocean" },
            { value: "Atlantic Ocean", label: "Atlantic Ocean" },
          ],
          correct: "Pacific Ocean",
        },
        {
          question: "How many Moons does the Earth have?",
          options: [
            { value: "2", label: "2" },
            { value: "1", label: "1" },
          ],
          correct: "1",
        },
      ];

      var eventName = "Quiz Submitted";
      let currentIndex = 0;
      const totalQuestions = quizData.length;
      const answers = {};
      let score = 0;

      const slider = document.getElementById("slider");
      quizData.forEach((data, index) => {
        const box = document.createElement("div");
        box.className = "box";
        box.innerHTML = `
<div class="question">${data.question}</div>
<div class="options">
${data.options
  .map(
    (opt, i) => `
<div class="option">
<input type="radio" id="q${index + 1}a${i + 1}" name="q${index + 1}" value="${
      opt.value
    }">
<label for="q${index + 1}a${i + 1}">${opt.label}</label>
</div>`
  )
  .join("")}
</div>
<div class="btn-group">
${
  index > 0
    ? `<button class="btn back-btn" onclick="prevQuestion()">Back</button>`
    : ""
}
${
  index < quizData.length - 1
    ? `<button class="btn next-btn" onclick="nextQuestion()">Next</button>`
    : `
<button class="btn next-btn" onclick="submitQuiz()">Submit</button>`
}
</div>`;
        slider.appendChild(box);
      });

      function updateSliderPosition() {
        slider.scrollTop = currentIndex * slider.clientHeight;
      }

      function getSelectedOption() {
        const radios = document.querySelectorAll(
          `input[name="q${currentIndex + 1}"]:checked`
        );
        return radios.length > 0 ? radios[0].value : null;
      }

      function nextQuestion() {
        const selectedOption = getSelectedOption();
        if (selectedOption) {
          answers[`q${currentIndex + 1}`] = selectedOption;
          currentIndex++;
          updateSliderPosition();
        } else {
          alert("Please select an option to proceed.");
        }
      }

      function prevQuestion() {
        currentIndex--;
        updateSliderPosition();
      }

      function submitQuiz() {
        const selectedOption = getSelectedOption();
        if (selectedOption) {
          answers[`q${currentIndex + 1}`] = selectedOption;
        }

        score = 0;
        quizData.forEach((question, index) => {
          const userAnswer = answers[`q${index + 1}`];
          if (userAnswer) {
            answers[`q${index + 1}`] = userAnswer;
            if (userAnswer === question.correct) {
              score++;
            }
          } else {
            answers[`q${index + 1}`] = "Not Answered";
          }
        });

        const result = score === totalQuestions ? "PASS" : "FAIL";
        answers.result = result;

        console.log("Selected Answers:", answers);
        console.log(`Your score: ${score}/${totalQuestions}`);
        console.log(`Result: ${result}`);

        const image = document.getElementById("header-image");
        const results = document.getElementById("results");

        slider.classList.add("hidden");
        image.classList.add("hidden");

        setTimeout(function () {
          document.location.href = "wzrk://thisleadstonowhere";
        }, 5000);

        setTimeout(() => {
          slider.style.display = "none";
          results.style.display = "block";
          results.classList.add("visible");
          document.querySelector(".container").style.backgroundColor =
            "transparent";

          if (score === totalQuestions) {
            results.textContent = "You have passed the quiz.";
            confetti();
          } else {
            results.textContent = "Better luck next time.";
          }
        }, 800);

        if (window.CleverTap) {
          CleverTap.pushEvent(eventName, JSON.stringify(answers));
        }

        if (
          window.webkit &&
          window.webkit.messageHandlers &&
          window.webkit.messageHandlers.clevertap
        ) {
          var message = {
            action: "recordEventWithProps",
            event: eventName,
            properties: answers,
          };
          window.webkit.messageHandlers.clevertap.postMessage(message);
          console.log(message);
        }
      }
    </script>
  </body>
</html>
